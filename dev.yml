- hosts: localhost
  connection: local
  become: yes

  vars:
    gopath: ~/go
    goroot: /usr/local/go

  tasks:
    # all package upgrade
    - name: apt-get update
      apt:
        update_cache: yes

    - name: apt-get upgrade
      apt:
        upgrade: dist

    # premise package for compile
    - name: build-essential
      apt:
        name: build-essential

    - name: curl
      apt:
        name: curl

    - name: gconf2
      apt:
        name: gconf2

    # nodejs and npm
    - name: nodejs apt setting
      shell: curl -sL https://deb.nodesource.com/setup_7.x | sudo -E bash -

    - name: nodejs install
      apt:
        name: nodejs
        state: latest

    - name: npm update
      npm:
        name: npm
        global: yes

    - name: webpack
      npm:
        name: webpack
        global: yes

    - name: js-beautify
      npm:
        name: js-beautify
        global: yes

    # fish shell
    - name: fish apt setting
      command: apt-add-repository ppa:fish-shell/release-2

    - name: apt-get update
      apt:
        update_cache: yes

    - name: fish install
      apt:
        name: fish

    - name: chsh
      user:
        name: grugrut
        shell: /usr/bin/fish

    # golang
    - name: go install
      unarchive:
        src: https://storage.googleapis.com/golang/go1.8.3.linux-amd64.tar.gz
        dest: /usr/local
        remote_src: yes

    - name: gocode
      shell: GOPATH={{gopath}} GOROOT={{goroot}} {{goroot}}/bin/go get -u github.com/nsf/gocode
      become: no

    - name: golint
      shell: GOPATH={{gopath}} GOROOT={{goroot}} {{goroot}}/bin/go get -u github.com/golang/lint/golint
      become: no

    - name: goimports
      shell: GOPATH={{gopath}} GOROOT={{goroot}} {{goroot}}/bin/go get -u golang.org/x/tools/cmd/goimports
      become: no


    # emacs
    - name: emacs apt setting
      command: apt-add-repository ppa:kelleyk/emacs

    - name: apt-get update
      apt:
        update_cache: yes

    - name: emacs install
      apt:
        name: emacs25

    - name: cmigemo
      apt:
        name: cmigemo

